import{_ as M,q as m,L as N,c as z,j as l,w as a,ac as S,o as j,ai as s,a as i,E as q}from"./index-B-gF0Q8n.js";import{E as O,a as G,b as H,c as J}from"./el-form-item-gdYdGMiI.js";/* empty css                 */import{l as K,s as b,E as n,m as Q,n as R}from"./request-DEHLP3YL.js";import{d as W,e as X,f as Y}from"./el-table-column-BGkG5Aqv.js";const Z={class:"card-header"},h={__name:"PlayersView",setup(ee){const E=m([]),c=m(!1),p=m(!1),d=m({id:null,name:"",info:""}),f=m(!1),u=m({name:"",info:""}),v=async()=>{try{const t=await b.get("/players");E.value=t.data.data}catch{n.error("获取选手列表失败！")}},g=()=>{u.value={name:"",info:""},f.value=!0},C=async()=>{if(!u.value.name||u.value.name.trim()===""){n.warning("选手姓名不能为空！");return}try{await b.post("/players",u.value),n.success("选手添加成功！"),f.value=!1,v()}catch{n.error("添加失败！")}},k=t=>{d.value={...t},p.value=!0},U=async()=>{if(!d.value.name||d.value.name.trim()===""){n.warning("选手姓名不能为空！");return}try{await b.put(`/players/${d.value.id}`,d.value),n.success("更新成功！"),p.value=!1,v()}catch{n.error("更新失败！")}},$=t=>{Y.confirm(`确定要删除选手【${t.name}】吗？此操作不可逆！`,"警告",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await b.delete(`/players/${t.id}`),n.success("删除成功！"),v()}catch{n.error("删除失败！")}}).catch(()=>{})},B=(t,e,r)=>{t&&t.count>0?(n.success(`成功导入 ${t.count} 名选手！`),c.value=!1,v()):n.warning("导入成功，但文件可能为空或格式不正确。")},D=(t,e,r)=>{n.error("文件上传失败，请检查文件格式或联系管理员。"),console.error(t)};return N(v),(t,e)=>{const r=Q,y=X,F=W,I=K,_=R,V=H,w=G,x=O,P=S("upload-filled"),T=q,A=J;return j(),z("div",null,[l(I,null,{header:a(()=>[i("div",Z,[e[12]||(e[12]=i("span",null,"选手列表",-1)),i("div",null,[l(r,{type:"success",onClick:g},{default:a(()=>[...e[10]||(e[10]=[s("手动录入",-1)])]),_:1}),l(r,{type:"primary",onClick:e[0]||(e[0]=o=>c.value=!0)},{default:a(()=>[...e[11]||(e[11]=[s("批量导入",-1)])]),_:1})])])]),default:a(()=>[l(F,{data:E.value,border:"",stripe:""},{default:a(()=>[l(y,{prop:"id",label:"ID",width:"80",align:"center"}),l(y,{prop:"name",label:"姓名"}),l(y,{prop:"info",label:"简介"}),l(y,{label:"操作",width:"180",align:"center"},{default:a(({row:o})=>[l(r,{type:"primary",size:"small",onClick:L=>k(o)},{default:a(()=>[...e[13]||(e[13]=[s("编辑",-1)])]),_:1},8,["onClick"]),l(r,{type:"danger",size:"small",onClick:L=>$(o)},{default:a(()=>[...e[14]||(e[14]=[s("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),l(x,{modelValue:f.value,"onUpdate:modelValue":e[4]||(e[4]=o=>f.value=o),title:"手动录入选手",width:"500","append-to-body":""},{footer:a(()=>[l(r,{onClick:e[3]||(e[3]=o=>f.value=!1)},{default:a(()=>[...e[15]||(e[15]=[s("取消",-1)])]),_:1}),l(r,{type:"primary",onClick:C},{default:a(()=>[...e[16]||(e[16]=[s("确定",-1)])]),_:1})]),default:a(()=>[l(w,{model:u.value,"label-width":"60px"},{default:a(()=>[l(V,{label:"姓名"},{default:a(()=>[l(_,{modelValue:u.value.name,"onUpdate:modelValue":e[1]||(e[1]=o=>u.value.name=o),placeholder:"请输入选手姓名"},null,8,["modelValue"])]),_:1}),l(V,{label:"简介"},{default:a(()=>[l(_,{modelValue:u.value.info,"onUpdate:modelValue":e[2]||(e[2]=o=>u.value.info=o),type:"textarea",placeholder:"请输入选手简介 (选填)"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(x,{modelValue:p.value,"onUpdate:modelValue":e[8]||(e[8]=o=>p.value=o),title:"编辑选手信息",width:"500","append-to-body":""},{footer:a(()=>[l(r,{onClick:e[7]||(e[7]=o=>p.value=!1)},{default:a(()=>[...e[17]||(e[17]=[s("取消",-1)])]),_:1}),l(r,{type:"primary",onClick:U},{default:a(()=>[...e[18]||(e[18]=[s("确定",-1)])]),_:1})]),default:a(()=>[l(w,{model:d.value,"label-width":"60px"},{default:a(()=>[l(V,{label:"姓名"},{default:a(()=>[l(_,{modelValue:d.value.name,"onUpdate:modelValue":e[5]||(e[5]=o=>d.value.name=o)},null,8,["modelValue"])]),_:1}),l(V,{label:"简介"},{default:a(()=>[l(_,{modelValue:d.value.info,"onUpdate:modelValue":e[6]||(e[6]=o=>d.value.info=o),type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(x,{modelValue:c.value,"onUpdate:modelValue":e[9]||(e[9]=o=>c.value=o),title:"批量导入选手 (CSV)",width:"500","append-to-body":""},{default:a(()=>[l(A,{drag:"",action:"/api/players/import",name:"playersFile",limit:1,"on-success":B,"on-error":D,accept:".xlsx, .xls"},{tip:a(()=>[...e[19]||(e[19]=[i("div",{class:"el-upload__tip"},[s(" 请上传 Excel 格式文件 (.xlsx 或 .xls)。"),i("br"),s(" 文件内容要求： A 列为姓名 B 列为简介，且不要有表头。 ")],-1)])]),default:a(()=>[l(T,{class:"el-icon--upload"},{default:a(()=>[l(P)]),_:1}),e[20]||(e[20]=i("div",{class:"el-upload__text"},[s(" 拖拽文件到此处 或 "),i("em",null,"点击上传")],-1))]),_:1})]),_:1},8,["modelValue"])])}}},se=M(h,[["__scopeId","data-v-d73157d9"]]);export{se as default};
